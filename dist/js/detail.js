"use strict";$(function(){$("#detailHeader").load("/html/head.html"),$("#detailFoot").load("/html/foot.html")});var url=location.href.substr(location.href.indexOf("?")+1),obj=changeObj(url);function detailHead(t){t='\n                <a target="_blank" href="../index.html">首页</a> &nbsp;/&nbsp;\n                <a href="javascript:;"></a>\n                <a href="javascript:void(0)">'+t.product_name+"</a>";$(".nav").html(t)}function detailRight_head(t){var a='\n                    <span style="font-size: 24px; color: rgb(0, 0, 0);">'+t.product_name+' <b class="yanse">'+t.product_specs[0].color_name+"</b> \n                    </span>";$(".main_right_p").html(a);a='\n            <span><i class="priceIcon">¥ </i>'+t.product_specs[0].price+"</span>";$(".PriceContent").html(a);a='\n                <div class="fangda">\n                    <img class="bigImg" src="//oss.static.nubia.cn/'+t.product_specs[0].images[0]+'">  \n                </div>\n                <div class="small">\n                    <img id="imgSrc" src="//oss.static.nubia.cn/'+t.product_specs[0].images[0]+'">   \n                     <div class="zzc"></div>\n                </div>';$(".img_datu").html(a);var e="";t.product_specs[0].images.forEach(function(t,a){e+=0==a?'\n                    <li class="liAtive">\n                        <img src="//oss.static.nubia.cn/'+t+'">\n                    </li>':'\n                    <li>\n                        <img src="//oss.static.nubia.cn/'+t+'">\n                    </li>'}),$("#img_thumb").html(e),zoom()}function detailRight_color(t){var e="";t.product_specs.forEach(function(t,a){e+=0==a?'\n            <li class="cur">'+t.color_name+"</li>":'\n            <li class="">'+t.color_name+"</li>"}),$("#selectColor").html(e)}function zoom(){$(".img_datu").mouseenter(function(){$(".zzc").css("display","block"),$(".fangda").css({display:"block","z-index":"10000000"})}),$(".img_datu").mouseleave(function(){$(".zzc").css("display","none"),$(".fangda").css("display"," none")}),$(".img_datu").mousemove(function(t){var a=($(".fangda img")[0].clientWidth-$(".fangda")[0].clientWidth)/($(".small img")[0].clientWidth-$(".zzc")[0].clientWidth);console.log(a);var e=offset($(".main_left")[0]),i=t.pageX-e.left-$(".zzc")[0].clientWidth/2,e=t.pageY-e.top-$(".zzc")[0].clientHeight/2;i<0?i=0:i>$(".img_datu")[0].clientWidth-$(".zzc")[0].clientWidth&&(i=$(".img_datu")[0].clientWidth-$(".zzc")[0].clientWidth),e<0?e=0:e>$(".img_datu")[0].clientHeight-$(".zzc")[0].clientHeight&&(e=$(".img_datu")[0].clientHeight-$(".zzc")[0].clientHeight),$(".zzc").css("left",i),$(".zzc").css("top",e);i=-i*a,a*=-e;$(".bigImg").css("left",i),$(".bigImg").css("top",a)})}obj.goods_id||(location.href="/html/shopp.html"),$.ajax({url:"/nbydetail",data:{specId:obj.goods_id,source:1},success:function(t){t.data.num=1,localStorage.setItem("detailNav",JSON.stringify(t.data)),localStorage.setItem("choose",JSON.stringify(t.data));var a=JSON.parse(localStorage.getItem("detailNav"));a.num=t.data.num;var e=[];a.product_specs=t.data.product_specs[0],e.push(a.product_specs),a.product_specs=e,localStorage.setItem("choose",JSON.stringify(a)),detailHead(t.data),detailRight_head(t.data),detailRight_color(t.data)}}),$("#selectColor").on("click","li",function(){var e=this.innerText;$(this).addClass("cur").siblings().removeClass("cur");var t=JSON.parse(localStorage.getItem("detailNav")),a=t.product_specs.filter(function(t,a){return e==t.color_name});t.product_specs=a,localStorage.setItem("choose",JSON.stringify(t)),detailRight_head(t)}),$("#img_thumb").on("click","li",function(){var t=$(this).children("img").attr("src");$("#imgSrc").attr("src",t),$(this).addClass("liAtive").siblings().removeClass("liAtive")}),$(".add").click(function(){var t=JSON.parse(localStorage.getItem("detailNav"));t.num+=1,localStorage.setItem("detailNav",JSON.stringify(t));var a=JSON.parse(localStorage.getItem("choose"));a.num=t.num,localStorage.setItem("choose",JSON.stringify(a)),$(".totle").html(t.num)}),$(".minus").click(function(){var t=JSON.parse(localStorage.getItem("detailNav"));t.num<=1?t.num:--t.num,localStorage.setItem("detailNav",JSON.stringify(t));var a=JSON.parse(localStorage.getItem("choose"));a.num=t.num,localStorage.setItem("choose",JSON.stringify(a)),$(".totle").html(t.num)}),$(".addShopCar").click(function(){var t,a=getCookie("login");a?(t=JSON.parse(localStorage.getItem("choose")),console.log(t),$.ajax({url:"/api/addCarData.php",data:{username:a,goods_id:t.default_sid,goods_color:t.product_specs[0].color_name,goods_name:t.product_name,goods_price:t.product_specs[0].price,goods_img:t.product_specs[0].images[0],goods_num:t.num},success:function(t){JSON.parse(t).code&&alert("添加购物车成功")}})):(t=location.href,localStorage.setItem("url",t),location.href="/html/login.html")});